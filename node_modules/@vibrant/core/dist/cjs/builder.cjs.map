{"version":3,"file":"builder.cjs","sources":["../../src/builder.ts"],"sourcesContent":["import { Filter } from \"@vibrant/color\";\nimport { assignDeep } from \"./utils\";\nimport { Vibrant } from \"./\";\nimport type { Callback } from \"@vibrant/types\";\nimport type { ImageClass, ImageSource } from \"@vibrant/image\";\n\nimport type { Palette } from \"@vibrant/color\";\nimport type { Options } from \"./options\";\n\nexport class Builder {\n\tprivate _src: ImageSource;\n\tprivate _opts: Partial<Options>;\n\tconstructor(src: ImageSource, opts: Partial<Options> = {}) {\n\t\tthis._src = src;\n\t\tthis._opts = assignDeep({}, Vibrant.DefaultOpts, opts);\n\t}\n\n\tmaxColorCount(n: number): Builder {\n\t\tthis._opts.colorCount = n;\n\t\treturn this;\n\t}\n\n\tmaxDimension(d: number): Builder {\n\t\tthis._opts.maxDimension = d;\n\t\treturn this;\n\t}\n\n\taddFilter(name: string): Builder {\n\t\tif (!this._opts.filters) {\n\t\t\tthis._opts.filters = [name];\n\t\t} else {\n\t\t\tthis._opts.filters.push(name);\n\t\t}\n\t\treturn this;\n\t}\n\n\tremoveFilter(name: string): Builder {\n\t\tif (this._opts.filters) {\n\t\t\tconst i = this._opts.filters.indexOf(name);\n\t\t\tif (i > 0) this._opts.filters.splice(i);\n\t\t}\n\t\treturn this;\n\t}\n\n\tclearFilters(): Builder {\n\t\tthis._opts.filters = [];\n\t\treturn this;\n\t}\n\n\tquality(q: number): Builder {\n\t\tthis._opts.quality = q;\n\t\treturn this;\n\t}\n\n\tuseImageClass(imageClass: ImageClass): Builder {\n\t\tthis._opts.ImageClass = imageClass;\n\t\treturn this;\n\t}\n\n\tuseGenerator(generator: string, options?: any): Builder {\n\t\tif (!this._opts.generators) this._opts.generators = [];\n\t\tthis._opts.generators.push(\n\t\t\toptions ? { name: generator, options } : generator,\n\t\t);\n\t\treturn this;\n\t}\n\n\tuseQuantizer(quantizer: string, options?: any): Builder {\n\t\tthis._opts.quantizer = options ? { name: quantizer, options } : quantizer;\n\t\treturn this;\n\t}\n\n\tbuild(): Vibrant {\n\t\treturn new Vibrant(this._src, this._opts);\n\t}\n\n\tgetPalette(cb?: Callback<Palette>): Promise<Palette> {\n\t\treturn this.build().getPalette(cb);\n\t}\n\tgetSwatches(cb?: Callback<Palette>): Promise<Palette> {\n\t\treturn this.build().getPalette(cb);\n\t}\n}\n"],"names":["assignDeep","Vibrant"],"mappings":";;;;AASO,MAAM,QAAQ;AAAA,EAGpB,YAAY,KAAkB,OAAyB,IAAI;AAC1D,SAAK,OAAO;AACZ,SAAK,QAAQA,MAAW,WAAA,CAAI,GAAAC,MAAA,QAAQ,aAAa,IAAI;AAAA,EAAA;AAAA,EAGtD,cAAc,GAAoB;AACjC,SAAK,MAAM,aAAa;AACjB,WAAA;AAAA,EAAA;AAAA,EAGR,aAAa,GAAoB;AAChC,SAAK,MAAM,eAAe;AACnB,WAAA;AAAA,EAAA;AAAA,EAGR,UAAU,MAAuB;AAC5B,QAAA,CAAC,KAAK,MAAM,SAAS;AACnB,WAAA,MAAM,UAAU,CAAC,IAAI;AAAA,IAAA,OACpB;AACD,WAAA,MAAM,QAAQ,KAAK,IAAI;AAAA,IAAA;AAEtB,WAAA;AAAA,EAAA;AAAA,EAGR,aAAa,MAAuB;AAC/B,QAAA,KAAK,MAAM,SAAS;AACvB,YAAM,IAAI,KAAK,MAAM,QAAQ,QAAQ,IAAI;AACzC,UAAI,IAAI,EAAG,MAAK,MAAM,QAAQ,OAAO,CAAC;AAAA,IAAA;AAEhC,WAAA;AAAA,EAAA;AAAA,EAGR,eAAwB;AAClB,SAAA,MAAM,UAAU,CAAC;AACf,WAAA;AAAA,EAAA;AAAA,EAGR,QAAQ,GAAoB;AAC3B,SAAK,MAAM,UAAU;AACd,WAAA;AAAA,EAAA;AAAA,EAGR,cAAc,YAAiC;AAC9C,SAAK,MAAM,aAAa;AACjB,WAAA;AAAA,EAAA;AAAA,EAGR,aAAa,WAAmB,SAAwB;AACvD,QAAI,CAAC,KAAK,MAAM,WAAiB,MAAA,MAAM,aAAa,CAAC;AACrD,SAAK,MAAM,WAAW;AAAA,MACrB,UAAU,EAAE,MAAM,WAAW,YAAY;AAAA,IAC1C;AACO,WAAA;AAAA,EAAA;AAAA,EAGR,aAAa,WAAmB,SAAwB;AACvD,SAAK,MAAM,YAAY,UAAU,EAAE,MAAM,WAAW,YAAY;AACzD,WAAA;AAAA,EAAA;AAAA,EAGR,QAAiB;AAChB,WAAO,IAAIA,MAAAA,QAAQ,KAAK,MAAM,KAAK,KAAK;AAAA,EAAA;AAAA,EAGzC,WAAW,IAA0C;AACpD,WAAO,KAAK,QAAQ,WAAW,EAAE;AAAA,EAAA;AAAA,EAElC,YAAY,IAA0C;AACrD,WAAO,KAAK,QAAQ,WAAW,EAAE;AAAA,EAAA;AAEnC;;"}